{\rtf1\mac\ansicpg10000\cocoartf102
{\fonttbl\f0\fswiss\fcharset77 Helvetica-Bold;\f1\fnil\fcharset77 Monaco;\f2\fswiss\fcharset77 Helvetica;
}
{\colortbl;\red255\green255\blue255;\red0\green115\blue0;\red0\green0\blue191;\red96\green96\blue96;
\red191\green0\blue0;}
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f0\b\fs36 \cf0 Group				
\fs28 \
\
superclass: Node\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f1\b0\fs18 \cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ri-620\ql\qnatural

\f2\fs24 \cf0 A Group is a collection of Nodes represented as a linked list. A new Node may be added to the head or tail of the group. The Nodes within a Group may be controlled together. The Nodes in a Group may be both Synths and other Groups. At startup there is a top level group with an ID of zero that defines the root of the tree.  This is represented by a subclass of Group: RootNode.\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f1\fs18 \cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f0\b\fs24 \cf0 	Group.new\

\f2\b0 		a new group at the head of the RootNode of the defaultServer\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f1\fs18 \cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f0\b\fs24 \cf0 	Group.after(aGroup)\

\f2\b0 		create a group and add immediately after aGroup, \
		in the same group,\
		on the same server \

\f0\b \
	Group.before(aGroup)\

\f2\b0 		create a group and add immediately before aGroup, \
		in the same group,\
		on the same server\

\f0\b \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f1\b0\fs18 \cf0 	
\f0\b\fs24 Group.head(aTarget)\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f2\b0 \cf0 		create and return a group...\
		if the target is \
			a group\
				add to the head of that group\
			a synth\
				add to the head of that synth's group\
			a server\
				add to the head of the RootNode of that server\
			nil\
				add to the head of the RootNode of the defaultServer\
				this would be equivalent to: Group.new\
				\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f1\fs18 \cf0 	
\f0\b\fs24 Group.tail(aTarget)\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f2\b0 \cf0 		create and return a group...\
		if the target is \
			a group\
				add to the tail of that group\
			a synth\
				add to the tail of that synth's group\
			a server\
				add to the tail of the RootNode of that server\
			nil\
				add to the tail of the RootNode of the defaultServer\
				\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f1\fs18 \cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f0\b\fs24 \cf0 	Group.new(target,addAction)\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f1\b0\fs18 \cf0 \
		
\f0\b\fs24 target\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f2\b0 \cf0 				using the method asTarget, the argument will be converted\
				to a Node.
\f1\fs18 \

\f2\fs24 					nil :  the RootNode of the defaultServer\
						this is the top level group.\
					Group, RootNode :\
						these objects are already Groups and need \
						no conversion\
					Synth:\
						the group of that synth\
					Server: \
						the RootNode of that server\
					\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f1\fs18 \cf0 			
\f0\b\fs24 addAction:  
\f2\b0 a symbol
\f1\fs18 \
				\cf2 \\addToHead
\f2\fs24 \cf0  (default)
\f1\fs18 \cf2 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f2\fs24 \cf0 					if the target is \
						a group\
							add to the head of that group\
						a synth\
							add to the head of that synth's group\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f1\fs18 \cf0 				\cf2 \\addToTail\cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f2\fs24 \cf0 					if the target is \
						a group\
							add to the tail of that group\
						a synth\
							add to the tail of that synth's group\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f1\fs18 \cf0 				\cf2 \\addAfter\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f2\fs24 \cf0 					add immediately after the target, \
					in the same group,\
					on the same server \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f1\fs18 \cf0 				\cf2 \\addBefore\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f2\fs24 \cf0 					add immediately before the target, \
					in the same group,\
					on the same server\
				
\f1\fs18 \cf2 \\addReplace\

\f2\fs24 \cf0 					replace the target,\
					in the same group,\
					on the same server\
					\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f0\b\fs28 \cf0 \ul Control\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f2\b0\fs24 \cf0 \ulnone 	See [Node]\
	The control commands (set,setn,fill,map) when sent to the group\
	operate on all of the nodes within that group!\
	\
	See the example below.\
		\
		\

\f0\b 	freeAll\

\f2\b0 		free all the nodes in the group, but do not free the group itself.\
	\
	
\f0\b do(function)\
		
\f2\b0 iterate over all the nodes in the group, valueing the function on each\

\f0\b 	deepDo(function)\

\f2\b0 		depth first traversal.\
		iterate over all the nodes in the group, and all the nodes in any group\
		within any groups within this group.\
\
\
\
\
First collect some things to play with.\
(they are slightly different than Synth examples!)\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural

\f1\fs18 \cf0 \
(\
s = \cf3 Server\cf0 .local;\
s.boot;\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf3 SynthDef\cf0 (\cf4 "moto-rev"\cf0 , \{ \cf3 arg\cf0  out=0,freq=100,ffreq=120;\
	\cf3 var\cf0  x;\
	x = \cf3 RLPF\cf0 .ar(\cf3 LFPulse\cf0 .ar(\cf3 SinOsc\cf0 .kr(0.2, 0, 10, freq), [0,0.1], 0.1), \
		ffreq, 0.1).clip2(0.4);\
	\cf3 Out\cf0 .ar(out, x);\
\}).send(s);\
\
\
\cf3 SynthDef\cf0 (\cf4 "wah"\cf0 , \{ \cf3 arg\cf0  out, rate = 1.5, cfreq = 1400, mfreq = 1200, rq=0.1;\
	\cf3 var\cf0  zin, zout;\
\
	zin = \cf3 In\cf0 .ar(out, 2);\
	cfreq = \cf3 Lag3\cf0 .kr(cfreq, 0.1);\
	mfreq = \cf3 Lag3\cf0 .kr(mfreq, 0.1);\
	rq   = \cf3 Ramp\cf0 .kr(rq, 0.1);\
	zout = \cf3 RLPF\cf0 .ar(zin, \cf3 LFNoise1\cf0 .kr(rate, mfreq, cfreq), rq, 10).distort \
		* 0.15;\
\
	\cf5 // replace the incoming bus with the effected version\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf0 	\cf3 ReplaceOut\cf0 .ar( out , zout ); \
	\
\}).send(s);\
\
)\
\
(\
\
g = \cf3 Group\cf0 .new;\
\
l = Array.fill(3,\{\
	\cf5 // random freq for each synth, added to g at the head\
\cf0 	\cf3 Synth\cf0 (\cf4 "moto-rev"\cf0 ,[\cf4 "out"\cf0 ,0,\cf4 "freq"\cf0 ,rrand(10,120)],g,\cf2 \\addToHead\cf0 );\
\});\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf5 // set all controls that match "ffreq" in all nodes in g to 90\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf0 g.set(\cf4 "ffreq"\cf0 ,300);\
\
g.set(\cf4 "freq"\cf0 ,80);\
\
r = \cf3 Routine\cf0 (\{\
	\cf3 inf\cf0 .do(\{\
		\cf5 //iterate over nodes in g\
\cf0 		l.do(\{ \cf3 arg\cf0  node;\
			node.set(\cf4 "freq"\cf0 ,rrand(10,120));\
			1.0.wait;\
		\});\
	\})\
\});\
\
r.play;\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf5 // g is in a group too, by default the RootNode top level group\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf0 g.group.inspect;\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf5 \
// asking a wah to go order-of-execution after g, in the same group as g.\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf0 x = \cf3 Synth\cf0 .after(g,\cf4 "wah"\cf0 ,[\cf4 "out"\cf0 ,0]); \cf5 // still all processing starting at bus 0\
\cf0 \
x.free;\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf5 // free all nodes in the group\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf0 g.freeAll;\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf5 // don't forget the Routine is still running...\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf0 r.stop;\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf5 // and i'm still playing, its just my children that were freed\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf0 g.isPlaying.postln;\
\
\
l = Array.fill(3,\{\
	\cf5 // random freq for each synth, added to g at the head\
\cf0 	s = \cf3 Synth\cf0 (\cf4 "moto-rev"\cf0 ,[\cf4 "out"\cf0 ,0,\cf4 "freq"\cf0 ,rrand(10,1200)],g,\cf2 \\addToHead\cf0 );\
\});\
\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf5 // kill me and my children\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf0 g.free;\
\
// the synths are freed, but need to free the nodeIDs\
l.do(\{ arg sy;\
	sy.free(sendFlag: false) // no need to send a message\
\});\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf5 //g.free will free the group AND all the nodes in one go.\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural
\cf0 g.isPlaying.postln;\
\
)\
\
\
\
}