<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title></title>
<meta name="Generator" content="Cocoa HTML Writer">
<meta name="CocoaVersion" content="824.42">
<style type="text/css">
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Helvetica}
p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Monaco; min-height: 16.0px}
p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco}
p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; min-height: 12.0px}
p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #a71e12}
p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #a71e12; min-height: 12.0px}
p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #0019b7}
p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #606060}
span.s1 {color: #0019b7}
span.s2 {color: #a71e12}
span.s3 {color: #000000}
span.s4 {color: #606060}
span.s5 {color: #326f17}
span.Apple-tab-span {white-space:pre}
</style>
</head>
<body>
<p class="p1"><b>Klank<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bank of resonators</b></p>
<p class="p2"><br></p>
<p class="p3"><b>Klank.ar(specificationsArrayRef, input, freqscale, freqoffset, decayscale)</b></p>
<p class="p2"><br></p>
<p class="p3">Klank is a bank of fixed frequency resonators which can be used to simulate the resonant modes of an object. Each mode is given a ring time, which is the time for the mode to decay by 60 dB.</p>
<p class="p2"><br></p>
<p class="p3"><b>specificationsArrayRef</b> - a Ref to an Array of three Arrays :</p>
<p class="p3"><span class="Apple-tab-span">	</span><b>frequencies</b> - an Array of filter frequencies.</p>
<p class="p3"><span class="Apple-tab-span">	</span><b>amplitudes</b> - an Array of filter amplitudes, or nil. If nil, then amplitudes default to 1.0</p>
<p class="p3"><span class="Apple-tab-span">	</span><b>ring</b> <b>times</b> - an Array of 60 dB decay times for the filters.</p>
<p class="p3">All subarrays, if not nil, should have the same length.</p>
<p class="p3"><b>input</b> - the excitation input to the resonant filter bank.</p>
<p class="p3"><b>freqscale</b> - a scale factor multiplied by all frequencies at initialization time.</p>
<p class="p3"><b>freqoffset</b> - an offset added to all frequencies at initialization time.</p>
<p class="p3"><b>decayscale</b> - a scale factor multiplied by all ring times at initialization time.</p>
<p class="p4"><br></p>
<p class="p5">{ <span class="s1">Klank</span>.ar(`[[800, 1071, 1153, 1723], <span class="s1">nil</span>, [1, 1, 1, 1]], <span class="s1">Impulse</span>.ar(2, 0, 0.1)) }.play;</p>
<p class="p6"><br></p>
<p class="p5">{ <span class="s1">Klank</span>.ar(`[[800, 1071, 1353, 1723], <span class="s1">nil</span>, [1, 1, 1, 1]], <span class="s1">Dust</span>.ar(8, 0.1)) }.play;</p>
<p class="p6"><br></p>
<p class="p5">{ <span class="s1">Klank</span>.ar(`[[800, 1071, 1353, 1723], <span class="s1">nil</span>, [1, 1, 1, 1]], <span class="s1">PinkNoise</span>.ar(0.007)) }.play;</p>
<p class="p6"><br></p>
<p class="p5">{ <span class="s1">Klank</span>.ar(`[[200, 671, 1153, 1723], <span class="s1">nil</span>, [1, 1, 1, 1]], <span class="s1">PinkNoise</span>.ar([0.007,0.007])) }.play;</p>
<p class="p6"><br></p>
<p class="p5">(</p>
<p class="p5">play({</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">Klank</span>.ar(`[<span class="Apple-converted-space"> </span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s1">Array</span>.rand(12, 800.0, 4000.0),<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">// frequencies</span></p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s1">nil</span><span class="s3">,<span class="Apple-converted-space">  <span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span></span>// amplitudes (default to 1.0)</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s1">Array</span>.rand(12, 0.1, 2)<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">// ring times</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>], <span class="s1">Decay</span>.ar(<span class="s1">Impulse</span>.ar(4), 0.03, <span class="s1">ClipNoise</span>.ar(0.01)))</p>
<p class="p5">})</p>
<p class="p5">)</p>
<p class="p6"><br></p>
<p class="p6"><br></p>
<p class="p6"><br></p>
<p class="p7">// a synth def that has 4 partials</p>
<p class="p5">(</p>
<p class="p5">s = <span class="s1">Server</span>.local;</p>
<p class="p5"><span class="s1">SynthDef</span>(<span class="s4">"help-Control"</span>, { <span class="s1">arg</span> out=0,i_freq;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> klank, n, harm, amp, ring;</p>
<p class="p6"><span class="Apple-tab-span">	</span></p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span></span>// harmonics</p>
<p class="p5"><span class="Apple-tab-span">	</span>harm = <span class="s1">Control</span>.names([<span class="s5">\harm</span>]).ir(<span class="s1">Array</span>.series(4,1,1).postln);</p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span></span>// amplitudes</p>
<p class="p5"><span class="Apple-tab-span">	</span>amp = <span class="s1">Control</span>.names([<span class="s5">\amp</span>]).ir(<span class="s1">Array</span>.fill(4,0.05));</p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span></span>// ring times</p>
<p class="p5"><span class="Apple-tab-span">	</span>ring = <span class="s1">Control</span>.names([<span class="s5">\ring</span>]).ir(<span class="s1">Array</span>.fill(4,1));</p>
<p class="p6"><span class="Apple-tab-span">	</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>klank = <span class="s1">Klank</span>.ar(`[harm,amp,ring], {<span class="s1">ClipNoise</span>.ar(0.003)}.dup, i_freq);</p>
<p class="p6"><span class="Apple-tab-span">	</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">Out</span>.ar(out, klank);</p>
<p class="p5">}).send(s);</p>
<p class="p5">)</p>
<p class="p6"><br></p>
<p class="p7">// nothing special yet, just using the default set of harmonics.</p>
<p class="p5">a = <span class="s1">Synth</span>(<span class="s4">"help-Control"</span>,[<span class="s5">\i_freq</span>, 300]);</p>
<p class="p5">b = <span class="s1">Synth</span>(<span class="s4">"help-Control"</span>,[<span class="s5">\i_freq</span>, 400]);</p>
<p class="p5">c = <span class="s1">Synth</span>(<span class="s4">"help-Control"</span>,[<span class="s5">\i_freq</span>, 533.33]);</p>
<p class="p5">d = <span class="s1">Synth</span>(<span class="s4">"help-Control"</span>,[<span class="s5">\i_freq</span>, 711.11]);</p>
<p class="p6"><br></p>
<p class="p5">a.free;</p>
<p class="p5">b.free;</p>
<p class="p5">c.free;</p>
<p class="p5">d.free;</p>
<p class="p6"><br></p>
<p class="p7">// in order to set the harmonics amps and ring times at</p>
<p class="p7">// initialization time we need to use an OSC bundle.</p>
<p class="p5">(</p>
<p class="p5">s.sendBundle(<span class="s1">nil</span>,</p>
<p class="p5"><span class="Apple-tab-span">	</span>[<span class="s4">"/s_new"</span>, <span class="s4">"help-Control"</span>, 2000, 1, 0, <span class="s5">\i_freq</span>, 500], <span class="s2">// start note</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>[<span class="s4">"/n_setn"</span>, 2000, <span class="s4">"harm"</span>, 4, 1, 3, 5, 7] <span class="s2">// set odd harmonics</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>);</p>
<p class="p5">)</p>
<p class="p6"><br></p>
<p class="p5">s.sendMsg(<span class="s4">"/n_free"</span>, 2000);</p>
<p class="p6"><br></p>
<p class="p5">(</p>
<p class="p5">s.sendBundle(<span class="s1">nil</span>,</p>
<p class="p5"><span class="Apple-tab-span">	</span>[<span class="s4">"/s_new"</span>, <span class="s4">"help-Control"</span>, 2000, 1, 0, <span class="s5">\i_freq</span>, 500], <span class="s2">// start note</span></p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span></span>// set geometric series harmonics</p>
<p class="p5"><span class="Apple-tab-span">	</span>[<span class="s4">"/n_setn"</span>, 2000, <span class="s4">"harm"</span>, 4] ++ <span class="s1">Array</span>.geom(4,1,1.61)</p>
<p class="p5"><span class="Apple-tab-span">	</span>);</p>
<p class="p5">)</p>
<p class="p6"><br></p>
<p class="p5">s.sendMsg(<span class="s4">"/n_free"</span>, 2000);</p>
<p class="p6"><br></p>
<p class="p5">(</p>
<p class="p7">// set harmonics, ring times and amplitudes</p>
<p class="p5">s.sendBundle(<span class="s1">nil</span>,</p>
<p class="p5"><span class="Apple-tab-span">	</span>[<span class="s4">"/s_new"</span>, <span class="s4">"help-Control"</span>, 2000, 1, 0, <span class="s5">\i_freq</span>, 500], <span class="s2">// start note</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>[<span class="s4">"/n_setn"</span>, 2000, <span class="s4">"harm"</span>, 4, 1, 3, 5, 7], <span class="s2">// set odd harmonics</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>[<span class="s4">"/n_setn"</span>, 2000, <span class="s4">"ring"</span>, 4] ++ <span class="s1">Array</span>.fill(4,0.1), <span class="s2">// set shorter ring time</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>[<span class="s4">"/n_setn"</span>, 2000, <span class="s4">"amp"</span>, 4] ++ <span class="s1">Array</span>.fill(4,0.2) <span class="s2">// set louder amps</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>);</p>
<p class="p5">)</p>
<p class="p6"><br></p>
<p class="p5">s.sendMsg(<span class="s5">\n_trace</span>, 2000);</p>
<p class="p5">s.sendMsg(<span class="s4">"/n_free"</span>, 2000);</p>
<p class="p6"><br></p>
<p class="p5">(</p>
<p class="p7">// same effect as above, but packed into one n_setn command</p>
<p class="p5">s.sendBundle(<span class="s1">nil</span>,</p>
<p class="p5"><span class="Apple-tab-span">	</span>[<span class="s4">"/s_new"</span>, <span class="s4">"help-Control"</span>, 2000, 1, 0, <span class="s5">\i_freq</span>, 500], <span class="s2">// start note</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>[<span class="s4">"/n_setn"</span>, 2000, <span class="s4">"harm"</span>, 4, 1, 3, 5, 7,</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s4">"ring"</span>, 4] ++ <span class="s1">Array</span>.fill(4,0.1)</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>++ [<span class="s4">"amp"</span>, 4] ++ <span class="s1">Array</span>.fill(4,0.2)</p>
<p class="p5"><span class="Apple-tab-span">	</span>);</p>
<p class="p5">)</p>
<p class="p6"><br></p>
<p class="p5">s.sendMsg(<span class="s4">"/n_free"</span>, 2000);</p>
<p class="p6"><br></p>
<p class="p6"><br></p>
<p class="p8"><br></p>
<p class="p8"><br></p>
<p class="p7">//////////////////////////////////////////////////////////////////////</p>
<p class="p6"><br></p>
<p class="p7">//-- overlap texture</p>
<p class="p5">(</p>
<p class="p9">SynthDef<span class="s3">(</span><span class="s4">"help-KlankOverlapTexture"</span><span class="s3">, {</span>|out = 0, freqs = #[0,0,0,0,0,0,0,0,0,0,0,0], rings = #[0,0,0,0,0,0,0,0,0,0,0,0], atk = 5, sus = 8, rel = 5, pan = 0|</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> e = <span class="s1">EnvGen</span>.kr(<span class="s1">Env</span>.linen(atk, sus, rel, 1, 4), doneAction:2);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> i = <span class="s1">Decay</span>.ar(<span class="s1">Impulse</span>.ar(<span class="s1">Rand</span>(0.8, 2.2)), 0.03, <span class="s1">ClipNoise</span>.ar(0.01));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> z = <span class="s1">Klank</span>.ar(</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>`[freqs, <span class="s1">nil</span>, rings],<span class="Apple-tab-span">	</span><span class="s2">// specs</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>i<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">// input</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">Out</span>.ar(out, <span class="s1">Pan2</span>.ar(z*e, pan));</p>
<p class="p5">}).send(s);</p>
<p class="p6"><br></p>
<p class="p9"><span class="s3">r = </span>Routine<span class="s3">{</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> sustain = 8, transition = 3, overlap = 4;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> period = transition*2+sustain/overlap;</p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span>0.5.wait;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>//wait for the synthdef to be sent to the server</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">inf</span>.do{</p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s1">Synth</span><span class="s3">(</span>"help-KlankOverlapTexture"<span class="s3">, [</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\atk</span>, transition,</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\sus</span>, sustain,</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\rel</span>, transition,</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\pan</span>, 1.0.rand2</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>]).setn(</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\freqs</span>, {200.0.rrand(4000)}.dup(12),</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\rings</span>, {0.1.rrand(2)}.dup(12)</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>period.wait;</p>
<p class="p5"><span class="Apple-tab-span">	</span>}</p>
<p class="p5">};</p>
<p class="p5">r.play;</p>
<p class="p5">)</p>
<p class="p6"><br></p>
<p class="p7"><span class="s3">r.stop;<span class="Apple-tab-span">	</span></span>//stop spawning new synths</p>
<p class="p6"><br></p>
<p class="p6"><br></p>
<p class="p6"><br></p>
<p class="p7">//-- frequency and decay scaling</p>
<p class="p5">(</p>
<p class="p9">SynthDef<span class="s3">(</span><span class="s4">"help-KlankScaling"</span><span class="s3">, {</span>|out = 0, freq = 0, rings = #[0,0,0,0,0,0,0,0,0,0,0,0], pan = 0|</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> e = <span class="s1">EnvGen</span>.kr(<span class="s1">Env</span>(#[1, 1, 0], #[0.4, 0.01]), doneAction:2);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> i = <span class="s1">Decay</span>.ar(<span class="s1">Impulse</span>.ar(0), 0.03, <span class="s1">ClipNoise</span>.ar(0.01));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> z = <span class="s1">Klank</span>.ar(</p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>`[(1..12), </span><span class="s1">nil</span><span class="s3">, rings],<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// specs (partials, amplitudes, ringtimes)</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>i,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">// input</span></p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>freq,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// scale to this frequency</p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0,<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// frequency offset</p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s1">MouseX</span><span class="s3">.kr(0.2, 3)<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// scale decay times</p>
<p class="p5"><span class="Apple-tab-span">	</span>);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">Out</span>.ar(out, <span class="s1">Pan2</span>.ar(z*e, pan));</p>
<p class="p5">}).send(s);</p>
<p class="p6"><br></p>
<p class="p9"><span class="s3">r = </span>Routine<span class="s3">{</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> sustain = 8, transition = 3;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> mode = #[0, 2, 4, 5, 7, 9, 11, 12, 14, 16, 17, 19, 21, 23, 24];</p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span>0.5.wait;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>//wait for the synthdef to be sent to the server</p>
<p class="p9"><span class="s3"><span class="Apple-tab-span">	</span></span>inf<span class="s3">.do{</span>|i|</p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s1">Synth</span><span class="s3">(</span>"help-KlankScaling"<span class="s3">, [</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\freq</span>, (72 + (mode @@ i)).midicps</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>]).setn(<span class="s5">\rings</span>, {0.1.rrand(2)}.dup(12));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.2.wait;</p>
<p class="p5"><span class="Apple-tab-span">	</span>}</p>
<p class="p5">};</p>
<p class="p5">r.play;</p>
<p class="p5">)</p>
<p class="p6"><br></p>
<p class="p5">r.stop;</p>
<p class="p6"><br></p>
<p class="p6"><br></p>
<p class="p7">//-- overlap texture 2</p>
<p class="p5">(</p>
<p class="p9">SynthDef<span class="s3">(</span><span class="s4">"help-KlankOverlapTexture2"</span><span class="s3">, {</span>|out = 0, freqs = #[0,0,0,0,0,0,0,0,0,0,0,0], rings = #[0,0,0,0,0,0,0,0,0,0,0,0], atk = 5, sus = 8, rel = 5, pan = 0|</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> e = <span class="s1">EnvGen</span>.kr(<span class="s1">Env</span>.linen(atk, sus, rel, 1, 4), doneAction:2);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> i = <span class="s1">BrownNoise</span>.ar(0.0012);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> z = <span class="s1">Klank</span>.ar(</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>`[freqs, <span class="s1">nil</span>, rings],<span class="Apple-tab-span">	</span><span class="s2">// specs</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>i<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">// input</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">Out</span>.ar(out, <span class="s1">Pan2</span>.ar(z*e, pan));</p>
<p class="p5">}).send(s);</p>
<p class="p6"><br></p>
<p class="p9"><span class="s3">r = </span>Routine<span class="s3">{</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> sustain = 6, transition = 4, overlap = 5;</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> period = transition*2+sustain/overlap;</p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span>0.5.wait;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>//wait for the synthdef to be sent to the server</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">inf</span>.do{</p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s1">Synth</span><span class="s3">(</span>"help-KlankOverlapTexture2"<span class="s3">, [</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\atk</span>, transition,</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\sus</span>, sustain,</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\rel</span>, transition,</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\pan</span>, 1.0.rand2</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>]).setn(</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\freqs</span>, {6000.0.linrand+80}.dup(12),</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\rings</span>, {0.1.rrand(3)}.dup(12)</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>period.wait;</p>
<p class="p5"><span class="Apple-tab-span">	</span>}</p>
<p class="p5">};</p>
<p class="p5">r.play;</p>
<p class="p5">)</p>
<p class="p6"><br></p>
<p class="p5">r.stop;</p>
<p class="p6"><br></p>
<p class="p6"><br></p>
<p class="p7">//-- overlap texture 3</p>
<p class="p5">(</p>
<p class="p9">SynthDef<span class="s3">(</span><span class="s4">"help-KlankOverlapTexture3"</span><span class="s3">, {</span>|out = 0, freqs = #[0,0,0,0,0,0,0,0,0,0,0,0], rings = #[0,0,0,0,0,0,0,0,0,0,0,0], pan = 0|</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> e = <span class="s1">EnvGen</span>.kr(<span class="s1">Env</span>(#[1, 1, 0], #[18, 3]), doneAction:2);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> i = <span class="s1">Decay</span>.ar(<span class="s1">Impulse</span>.ar(<span class="s1">Rand</span>(0.2, 0.6)), 0.8, <span class="s1">ClipNoise</span>.ar(0.001));</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">var</span> z = <span class="s1">Klank</span>.ar(</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>`[freqs, <span class="s1">2</span>, rings],<span class="Apple-tab-span">	</span><span class="s2">// specs</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>i<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s2">// input</span></p>
<p class="p5"><span class="Apple-tab-span">	</span>);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">Out</span>.ar(out, <span class="s1">Pan2</span>.ar(z*e, pan));</p>
<p class="p5">}).send(s);</p>
<p class="p6"><br></p>
<p class="p9"><span class="s3">r = </span>Routine<span class="s3">{</span></p>
<p class="p7"><span class="s3"><span class="Apple-tab-span">	</span>0.5.wait;<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>//wait for the synthdef to be sent to the server</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="s1">inf</span>.do{</p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span><span class="s1">Synth</span><span class="s3">(</span>"help-KlankOverlapTexture3"<span class="s3">, [</span></p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\pan</span>, 1.0.rand2</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>]).setn(</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\freqs</span>, {12000.0.linrand+80}.dup(12),</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s5">\rings</span>, {3.rrand(10)}.dup(12)</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>);</p>
<p class="p5"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>3.wait;</p>
<p class="p5"><span class="Apple-tab-span">	</span>}</p>
<p class="p5">};</p>
<p class="p5">r.play;</p>
<p class="p5">)</p>
<p class="p6"><br></p>
<p class="p5">r.stop;</p>
<p class="p6"><br></p>
</body>
</html>
